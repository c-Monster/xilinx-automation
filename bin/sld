#!/bin/bash

DEVICE=$1 # arguments
BURNBIT=$2
CHARBIT=$3
ELFFILE=$4

if [ $DEVICE = "control" ] || [ $DEVICE = "burn" ] || [ $DEVICE = "test" ]; then

    DATE=$( date '+%m.%d.%y-%H.%M' )

    for i in {0..3}; do 

        # characterize 
        LOGFILE="/home/adam/RO-PUF/runs/logs/$DEVICE/$DATE/characterization_$i" 
	touch $LOGFILE
        echo "$CHARBIT\n$ELFFILE" > "$LOGFILE"
        characterize.exp $CHARBIT $ELFFILE >> $LOGPATH			 
        
        # burn for one hour
        burn.exp $BURNBIT							   
        sleep 5s

    done

    # TODO get rid of annoying  character
else
    echo "usage: [ control | burn | test ] [ shorts ] [ bitstream ] [ elf file ] "
fi

